<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>移动端图表切换测试</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f9f9f9;
        }
        
        .test-container {
            max-width: 400px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .chart-indicators {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
            padding: 10px 0;
        }

        .indicator-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #ddd;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .indicator-dot.active {
            background: #4285f4;
            transform: scale(1.2);
            border-color: rgba(66, 133, 244, 0.3);
        }

        .chart-swiper {
            position: relative;
            overflow: hidden;
            width: 100%;
            min-height: 200px;
            border: 1px solid #eee;
            border-radius: 8px;
        }

        .chart-slide {
            display: none;
            width: 100%;
            opacity: 0;
            transform: translateX(20px);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            padding: 20px;
            text-align: center;
        }

        .chart-slide.active {
            display: block;
            opacity: 1;
            transform: translateX(0);
            position: relative;
        }
        
        .slide-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 20px;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
        }
        
        .slide-1 { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        .slide-2 { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
        .slide-3 { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
    </style>
</head>
<body>
    <div class="test-container">
        <h2>图表切换测试</h2>
        <p>点击下方的点或滑动来切换图表</p>
        
        <!-- 图表指示器点 -->
        <div class="chart-indicators">
            <div class="indicator-dot active" data-chart="0" onclick="switchChart(0)"></div>
            <div class="indicator-dot" data-chart="1" onclick="switchChart(1)"></div>
            <div class="indicator-dot" data-chart="2" onclick="switchChart(2)"></div>
        </div>
        
        <!-- 可滑动的图表容器 -->
        <div class="chart-swiper" id="chartSwiper">
            <div class="chart-slide active" id="slide-0">
                <div class="slide-content slide-1">
                    坐姿时间占比图表<br/>
                    <small>饼图显示良好/不良坐姿比例</small>
                </div>
            </div>
            
            <div class="chart-slide" id="slide-1">
                <div class="slide-content slide-2">
                    不良姿态时段分布<br/>
                    <small>热力图显示时段分布</small>
                </div>
            </div>
            
            <div class="chart-slide" id="slide-2">
                <div class="slide-content slide-3">
                    坐姿图像记录<br/>
                    <small>图像库展示历史记录</small>
                </div>
            </div>
        </div>
        
        <p style="margin-top: 20px; color: #666; font-size: 14px;">
            提示：在移动设备上可以左右滑动切换
        </p>
    </div>

    <script>
        let currentChartIndex = 0;
        const chartConfig = [
            { title: '坐姿时间占比' },
            { title: '不良姿态时段分布' }, 
            { title: '坐姿图像记录' }
        ];

        function switchChart(index) {
            if (index === currentChartIndex) return;
            
            const slides = document.querySelectorAll('.chart-slide');
            const indicators = document.querySelectorAll('.indicator-dot');
            
            // 更新指示器
            indicators.forEach((dot, i) => {
                dot.classList.toggle('active', i === index);
            });
            
            // 切换动画
            const currentSlide = slides[currentChartIndex];
            const nextSlide = slides[index];
            
            if (currentSlide && nextSlide) {
                // 淡出当前幻灯片
                currentSlide.style.opacity = '0';
                currentSlide.style.transform = index > currentChartIndex ? 'translateX(-20px)' : 'translateX(20px)';
                
                setTimeout(() => {
                    currentSlide.classList.remove('active');
                    
                    // 淡入新幻灯片
                    nextSlide.classList.add('active');
                    nextSlide.style.opacity = '0';
                    nextSlide.style.transform = index > currentChartIndex ? 'translateX(20px)' : 'translateX(-20px)';
                    
                    setTimeout(() => {
                        nextSlide.style.opacity = '1';
                        nextSlide.style.transform = 'translateX(0)';
                    }, 50);
                }, 200);
            }
            
            currentChartIndex = index;
        }

        // 添加触摸滑动支持
        function setupChartSwiper() {
            const swiper = document.getElementById('chartSwiper');
            if (!swiper) return;
            
            let startX = 0;
            let isSwipping = false;
            
            swiper.addEventListener('touchstart', function(e) {
                startX = e.touches[0].clientX;
                isSwipping = true;
            });
            
            swiper.addEventListener('touchmove', function(e) {
                if (!isSwipping) return;
                e.preventDefault();
            });
            
            swiper.addEventListener('touchend', function(e) {
                if (!isSwipping) return;
                
                const endX = e.changedTouches[0].clientX;
                const diffX = startX - endX;
                const threshold = 50;
                
                if (Math.abs(diffX) > threshold) {
                    if (diffX > 0) {
                        // 向左滑，显示下一个图表
                        const nextIndex = (currentChartIndex + 1) % chartConfig.length;
                        switchChart(nextIndex);
                    } else {
                        // 向右滑，显示上一个图表
                        const prevIndex = (currentChartIndex - 1 + chartConfig.length) % chartConfig.length;
                        switchChart(prevIndex);
                    }
                }
                
                isSwipping = false;
            });
        }

        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            setupChartSwiper();
        });
    </script>
</body>
</html>
