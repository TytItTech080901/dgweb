<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>曈灵智能台灯家长端 - 移动端</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/mobile.css') }}">
    <!-- 引入字体图标库 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <!-- 引入Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
</head>
<body>
    <header>
        <h1>曈灵智能台灯家长端</h1>
        <div class="subtitle">全面了解孩子的坐姿习惯及改善效果</div>
    </header>
    
    <div class="mobile-container">
        <!-- 首页 -->
        <div id="home" class="mobile-page">
            <div class="mobile-dashboard">
                <!-- 我的工具卡片 -->
                <div class="mobile-card">
                    <div class="mobile-card-header">
                        <div class="mobile-card-title">我的工具</div>
                    </div>
                    <div class="mobile-card-content">
                        <div class="tools-grid">
                            <div class="tool-item" data-tool="posture">
                                <div class="tool-icon">
                                    <i class="bi bi-person-standing"></i>
                                </div>
                                <div class="tool-title">坐姿检测</div>
                                <div class="tool-desc">实时监测坐姿健康</div>
                            </div>
                            <div class="tool-item" data-tool="eye">
                                <div class="tool-icon">
                                    <i class="bi bi-eye"></i>
                                </div>
                                <div class="tool-title">用眼情况</div>
                                <div class="tool-desc">关注视力健康</div>
                            </div>
                            <div class="tool-item" data-tool="emotion">
                                <div class="tool-icon">
                                    <i class="bi bi-emoji-smile"></i>
                                </div>
                                <div class="tool-title">情绪反馈</div>
                                <div class="tool-desc">了解情绪状态</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 今日概览卡片 -->
                <div class="mobile-card">
                    <div class="mobile-card-header">
                        <div class="mobile-card-title">今日概览</div>
                        <div class="status-indicator status-running">
                            <span class="status-dot"></span>
                            <span class="status-text">运行中</span>
                        </div>
                    </div>
                    <div class="mobile-card-content">
                        <div class="overview-stats">
                            <div class="stat-item">
                                <div class="stat-value" id="studyTime">4.5h</div>
                                <div class="stat-label">学习时长</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value" id="postureScore">85%</div>
                                <div class="stat-label">姿势正确率</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value" id="eyeRest">12</div>
                                <div class="stat-label">眼部休息次数</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 家长监护页面 -->
        <div id="guardian" class="mobile-page" style="display: none;">
            <div class="mobile-dashboard">
                <!-- 实时监控卡片 -->
                <div class="mobile-card">
                    <div class="mobile-card-header">
                        <div class="mobile-card-title">实时监控画面</div>
                        <div class="monitor-status">
                            <span class="status-dot status-live"></span>
                            <span>直播中</span>
                        </div>
                    </div>
                    <div class="mobile-card-content">
                        <div class="video-container">
                            <img id="guardianVideo" src="/video_feed" alt="监控视频">
                            <div class="video-controls">
                                <button class="video-btn" id="pauseVideo">
                                    <i class="bi bi-pause"></i>
                                </button>
                                <button class="video-btn" id="captureBtn">
                                    <i class="bi bi-camera"></i>
                                </button>
                                <button class="video-btn" id="fullscreenBtn">
                                    <i class="bi bi-fullscreen"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 消息推送卡片 -->
                <div class="mobile-card">
                    <div class="mobile-card-header">
                        <div class="mobile-card-title">消息推送</div>
                        <button class="btn-mini" id="addMessage">
                            <i class="bi bi-plus"></i>
                        </button>
                    </div>
                    <div class="mobile-card-content">
                        <div class="message-input">
                            <textarea id="messageContent" placeholder="输入要发送的消息..." rows="3"></textarea>
                            <div class="message-actions">
                                <select id="messageType">
                                    <option value="immediate">立即发送</option>
                                    <option value="scheduled">定时发送</option>
                                </select>
                                <button class="mobile-btn" id="sendMessage">发送</button>
                            </div>
                        </div>
                        
                        <!-- 消息历史 -->
                        <div class="message-history" id="messageHistory">
                            <div class="message-item sent">
                                <div class="message-sender">
                                    <i class="bi bi-person-check"></i>
                                    家长
                                </div>
                                <div class="message-content">记得保持正确坐姿哦</div>
                                <div class="message-time">14:30</div>
                            </div>
                            <div class="message-item scheduled">
                                <div class="message-sender">
                                    <i class="bi bi-clock"></i>
                                    定时消息
                                </div>
                                <div class="message-content">该休息一下眼睛了</div>
                                <div class="message-time">15:00 (预定)</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 远程控制页面 -->
        <div id="remote" class="mobile-page" style="display: none;">
            <div class="mobile-dashboard">
                <!-- 台灯状态卡片 -->
                <div class="mobile-card">
                    <div class="mobile-card-header">
                        <div class="mobile-card-title">台灯状态</div>
                        <div class="status-indicator">
                            <span class="status-dot"></span>
                            <span id="lampStatus" class="status-text">已开启</span>
                        </div>
                    </div>
                    <div class="mobile-card-content">
                        <div class="status-grid">
                            <div class="status-item">
                                <div class="status-icon">
                                    <i class="bi bi-lightbulb-fill"></i>
                                </div>
                                <div class="status-info">
                                    <div class="status-value" id="currentBrightness">500</div>
                                    <div class="status-label">当前亮度</div>
                                </div>
                            </div>
                            <div class="status-item">
                                <div class="status-icon">
                                    <i class="bi bi-thermometer-half"></i>
                                </div>
                                <div class="status-info">
                                    <div class="status-value" id="currentTemperature">5300K</div>
                                    <div class="status-label">当前色温</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 灯光控制与护眼设置合并卡片 -->
                <div class="mobile-card">
                    <div class="mobile-card-header">
                        <div class="mobile-card-title">灯光与护眼</div>
                        <div class="control-icon">
                            <i class="bi bi-lightbulb"></i>
                        </div>
                    </div>
                    <div class="mobile-card-content">
                        <!-- 切换按钮 -->
                        <div class="light-eye-switcher">
                            <button class="light-eye-btn active" onclick="switchLightEyeContent('light')">
                                <i class="bi bi-toggles"></i>
                                灯光控制
                            </button>
                            <button class="light-eye-btn" onclick="switchLightEyeContent('eye')">
                                <i class="bi bi-eye"></i>
                                护眼设置
                            </button>
                        </div>

                        <!-- 灯光控制内容 -->
                        <div class="light-eye-content" id="light-content">
                            <div class="light-controls">
                                <!-- 台灯电源和灯光开关横向排列 -->
                                <div class="lamp-controls-row">
                                    <button class="lamp-control-btn" id="power-btn" onclick="togglePower()">
                                        <i class="bi bi-power"></i>
                                        台灯电源
                                    </button>
                                    <button class="lamp-control-btn" id="light-btn" onclick="toggleLight()">
                                        <i class="bi bi-lightbulb"></i>
                                        灯光开关
                                    </button>
                                </div>

                                <!-- 亮度调节 -->
                                <div class="control-group">
                                    <label class="control-label">
                                        亮度调节
                                        <span class="control-value" id="brightness-display">500</span>
                                    </label>
                                    <div class="slider-container">
                                        <input type="range" id="brightness-slider" min="0" max="1000" value="500" 
                                               class="range-slider brightness-slider" oninput="adjustBrightness(this.value)">
                                        <div class="slider-marks">
                                            <span>0</span>
                                            <span>250</span>
                                            <span>500</span>
                                            <span>750</span>
                                            <span>1000</span>
                                        </div>
                                    </div>
                                    <div class="quick-buttons">
                                        <button class="quick-btn" onclick="setBrightness(200)">护眼</button>
                                        <button class="quick-btn" onclick="setBrightness(500)">标准</button>
                                        <button class="quick-btn" onclick="setBrightness(800)">明亮</button>
                                    </div>
                                </div>

                                <!-- 色温调节 -->
                                <div class="control-group">
                                    <label class="control-label">
                                        色温调节
                                        <span class="control-value" id="temperature-display">5300K</span>
                                    </label>
                                    <div class="slider-container">
                                        <input type="range" id="temperature-slider" min="3000" max="6500" value="5300" 
                                               class="range-slider temperature-slider" oninput="adjustTemperature(this.value)">
                                        <div class="slider-marks">
                                            <span>3000K<br><small>暖光</small></span>
                                            <span>4000K</span>
                                            <span>5000K</span>
                                            <span>6000K</span>
                                            <span>6500K<br><small>冷光</small></span>
                                        </div>
                                    </div>
                                    <div class="quick-buttons">
                                        <button class="quick-btn" onclick="setTemperature(3000)">暖光</button>
                                        <button class="quick-btn" onclick="setTemperature(4000)">自然</button>
                                        <button class="quick-btn" onclick="setTemperature(5300)">标准</button>
                                        <button class="quick-btn" onclick="setTemperature(6500)">冷光</button>
                                    </div>
                                </div>

                                <!-- 应用设置按钮 -->
                                <div class="control-group">
                                    <button class="mobile-btn primary apply-btn" onclick="applyLightSettings()">
                                        <i class="bi bi-stars"></i>
                                        应用设置到台灯
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- 护眼设置内容 -->
                        <div class="light-eye-content" id="eye-content" style="display: none;">
                            <div class="eye-care-settings">
                                <!-- 远眺休息设置 -->
                                <div class="setting-group">
                                    <h4 class="setting-title">远眺休息间隔</h4>
                                    <p class="setting-desc">设置孩子远眺休息的时间间隔</p>
                                    <div class="setting-control">
                                        <div class="input-group">
                                            <input type="number" id="rest-interval" min="10" max="120" value="20" class="setting-input">
                                            <span class="input-unit">分钟</span>
                                        </div>
                                        <div class="preset-buttons">
                                            <button class="preset-btn" onclick="setRestInterval(15)">15分钟</button>
                                            <button class="preset-btn active" onclick="setRestInterval(20)">20分钟</button>
                                            <button class="preset-btn" onclick="setRestInterval(30)">30分钟</button>
                                        </div>
                                    </div>
                                </div>

                                <!-- 长时间用眼提醒 -->
                                <div class="setting-group">
                                    <h4 class="setting-title">长时间用眼提醒</h4>
                                    <p class="setting-desc">连续用眼超过设定时间时自动提醒</p>
                                    <div class="setting-control">
                                        <div class="input-group">
                                            <input type="number" id="continuous-time" min="30" max="180" value="45" class="setting-input">
                                            <span class="input-unit">分钟</span>
                                        </div>
                                        <div class="preset-buttons">
                                            <button class="preset-btn" onclick="setContinuousTime(30)">30分钟</button>
                                            <button class="preset-btn active" onclick="setContinuousTime(45)">45分钟</button>
                                            <button class="preset-btn" onclick="setContinuousTime(60)">60分钟</button>
                                        </div>
                                    </div>
                                </div>

                                <!-- 护眼模式开关 -->
                                <div class="setting-group">
                                    <h4 class="setting-title">护眼模式</h4>
                                    <p class="setting-desc">自动调节灯光到护眼状态</p>
                                    <div class="setting-control">
                                        <div class="switch-container">
                                            <label class="switch">
                                                <input type="checkbox" id="eye-care-mode" onchange="toggleEyeCareMode()">
                                                <span class="slider round"></span>
                                            </label>
                                            <span class="switch-text" id="eye-care-mode-text">已关闭</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 设置页面 -->
        <div id="settings" class="mobile-page" style="display: none;">
            <div class="mobile-dashboard">
                <!-- 通知设置卡片 -->
                <div class="mobile-card">
                    <div class="mobile-card-header">
                        <div class="mobile-card-title">通知设置</div>
                    </div>
                    <div class="mobile-card-content">
                        <div class="setting-list">
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-title">姿势提醒</div>
                                    <div class="setting-desc">检测到不良姿势时发送通知</div>
                                </div>
                                <button class="setting-toggle active" data-setting="posture">
                                    <i class="bi bi-toggle-on"></i>
                                </button>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-title">用眼提醒</div>
                                    <div class="setting-desc">连续用眼时间过长时提醒</div>
                                </div>
                                <button class="setting-toggle active" data-setting="eye">
                                    <i class="bi bi-toggle-on"></i>
                                </button>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-title">情绪异常</div>
                                    <div class="setting-desc">检测到情绪异常时通知</div>
                                </div>
                                <button class="setting-toggle" data-setting="emotion">
                                    <i class="bi bi-toggle-off"></i>
                                </button>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-title">学习报告</div>
                                    <div class="setting-desc">每日学习报告推送</div>
                                </div>
                                <button class="setting-toggle active" data-setting="report">
                                    <i class="bi bi-toggle-on"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 监控设置卡片 -->
                <div class="mobile-card">
                    <div class="mobile-card-header">
                        <div class="mobile-card-title">监控设置</div>
                    </div>
                    <div class="mobile-card-content">
                        <div class="setting-list">
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-title">检测灵敏度</div>
                                    <div class="setting-desc">调整姿势检测的敏感程度</div>
                                </div>
                                <select class="setting-select">
                                    <option value="low">低</option>
                                    <option value="medium" selected>中</option>
                                    <option value="high">高</option>
                                </select>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-title">拍照频率</div>
                                    <div class="setting-desc">自动拍照的时间间隔</div>
                                </div>
                                <select class="setting-select">
                                    <option value="5">5分钟</option>
                                    <option value="10" selected>10分钟</option>
                                    <option value="15">15分钟</option>
                                    <option value="30">30分钟</option>
                                </select>
                            </div>
                            <div class="setting-item">
                                <div class="setting-info">
                                    <div class="setting-title">数据保存</div>
                                    <div class="setting-desc">历史数据保留时间</div>
                                </div>
                                <select class="setting-select">
                                    <option value="7">7天</option>
                                    <option value="30" selected>30天</option>
                                    <option value="90">90天</option>
                                    <option value="365">1年</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 账户设置卡片 -->
                <div class="mobile-card">
                    <div class="mobile-card-header">
                        <div class="mobile-card-title">账户设置</div>
                    </div>
                    <div class="mobile-card-content">
                        <div class="account-info">
                            <div class="avatar-section">
                                <div class="avatar">
                                    <i class="bi bi-person-circle"></i>
                                </div>
                                <div class="user-info">
                                    <div class="username">家长用户</div>
                                    <div class="user-role">管理员</div>
                                </div>
                            </div>
                            
                            <div class="account-actions">
                                <button class="action-item">
                                    <i class="bi bi-person"></i>
                                    <span>修改个人信息</span>
                                    <i class="bi bi-chevron-right"></i>
                                </button>
                                <button class="action-item">
                                    <i class="bi bi-shield-lock"></i>
                                    <span>修改密码</span>
                                    <i class="bi bi-chevron-right"></i>
                                </button>
                                <button class="action-item">
                                    <i class="bi bi-wifi"></i>
                                    <span>网络设置</span>
                                    <i class="bi bi-chevron-right"></i>
                                </button>
                                <button class="action-item">
                                    <i class="bi bi-download"></i>
                                    <span>数据导出</span>
                                    <i class="bi bi-chevron-right"></i>
                                </button>
                                <button class="action-item">
                                    <i class="bi bi-question-circle"></i>
                                    <span>帮助与反馈</span>
                                    <i class="bi bi-chevron-right"></i>
                                </button>
                                <button class="action-item logout">
                                    <i class="bi bi-box-arrow-right"></i>
                                    <span>退出登录</span>
                                    <i class="bi bi-chevron-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 系统信息卡片 -->
                <div class="mobile-card">
                    <div class="mobile-card-header">
                        <div class="mobile-card-title">系统信息</div>
                    </div>
                    <div class="mobile-card-content">
                        <div class="system-info">
                            <div class="info-item">
                                <span class="info-label">应用版本</span>
                                <span class="info-value">v2.1.0</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">最后更新</span>
                                <span class="info-value">2025-07-20</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">设备ID</span>
                                <span class="info-value">TL-001-2025</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 工具详情页面 -->
        <div id="tool-detail" class="mobile-page" style="display: none;">
            <div class="tool-header">
                <button class="back-btn" onclick="showPage('home')">
                    <i class="bi bi-arrow-left"></i>
                </button>
                <h3 id="toolTitle">坐姿检测</h3>
                <div></div>
            </div>
            
            <div class="mobile-dashboard">
                <!-- 坐姿检测内容 -->
                <div id="posture-content" class="tool-content">
                    <!-- 时间范围选择器 -->
                    <div class="time-range-selector">
                        <button class="time-range-btn active" data-range="day" onclick="changeTimeRange('day')">今日</button>
                        <button class="time-range-btn" data-range="week" onclick="changeTimeRange('week')">本周</button>
                        <button class="time-range-btn" data-range="month" onclick="changeTimeRange('month')">本月</button>
                    </div>
                    
                    <!-- 坐姿改善建议卡片 -->
                    <div class="mobile-card improvement-suggestion">
                        <div class="mobile-card-header">
                            <div class="mobile-card-title">坐姿改善建议</div>
                            <div class="suggestion-icon">
                                <i class="bi bi-lightbulb"></i>
                            </div>
                        </div>
                        <div class="mobile-card-content">
                            <div class="suggestion-content">
                                <div class="suggestion-item">
                                    <div class="suggestion-indicator warning"></div>
                                    <div class="suggestion-text">
                                        根据数据分析，您孩子在下午3-5点时段坐姿不良率较高，建议加强这个时段的监督或调整学习环境。
                                    </div>
                                </div>
                                <div class="suggestion-item">
                                    <div class="suggestion-indicator info"></div>
                                    <div class="suggestion-text">
                                        本周坐姿改善效果明显，请继续保持良好习惯。
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 数据分析图表滑动模块 -->
                    <div class="mobile-card">
                        <div class="mobile-card-header">
                            <div class="mobile-card-title" id="chartTitle">坐姿时间占比</div>
                            <div class="chart-icon" id="chartIcon">
                                <i class="bi bi-pie-chart"></i>
                            </div>
                        </div>
                        <div class="mobile-card-content">
                            <!-- 图表指示器点 -->
                            <div class="chart-indicators">
                                <div class="indicator-dot active" data-chart="0" onclick="switchChart(0)"></div>
                                <div class="indicator-dot" data-chart="1" onclick="switchChart(1)"></div>
                                <div class="indicator-dot" data-chart="2" onclick="switchChart(2)"></div>
                            </div>
                            
                            <!-- 可滑动的图表容器 -->
                            <div class="chart-swiper" id="chartSwiper">
                                <!-- 坐姿时间占比图表 -->
                                <div class="chart-slide active" id="slide-0">
                                    <div class="chart-container">
                                        <canvas id="posturePieChart"></canvas>
                                    </div>
                                    <div class="stats-grid">
                                        <div class="stat-item">
                                            <div class="stat-value" id="goodPostureTime">3.2h</div>
                                            <div class="stat-label">良好坐姿</div>
                                        </div>
                                        <div class="stat-item">
                                            <div class="stat-value" id="mildBadPostureTime">1.2h</div>
                                            <div class="stat-label">轻度不良坐姿</div>
                                        </div>
                                        <div class="stat-item">
                                            <div class="stat-value" id="badPostureTime">0.6h</div>
                                            <div class="stat-label">不良坐姿</div>
                                        </div>
                                        <div class="stat-item">
                                            <div class="stat-value" id="postureRate">64%</div>
                                            <div class="stat-label">良好率</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- 不良姿态时段分布图表 -->
                                <div class="chart-slide" id="slide-1">
                                    <div class="chart-container">
                                        <canvas id="heatmapChart"></canvas>
                                    </div>
                                    <div class="heatmap-legend">
                                        <div class="legend-item">
                                            <div class="legend-color low"></div>
                                            <span>良好</span>
                                        </div>
                                        <div class="legend-item">
                                            <div class="legend-color medium"></div>
                                            <span>一般</span>
                                        </div>
                                        <div class="legend-item">
                                            <div class="legend-color high"></div>
                                            <span>较差</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- 坐姿图像记录 -->
                                <div class="chart-slide" id="slide-2">
                                    <div id="posture-images-container" class="mobile-image-gallery">
                                        <!-- 坐姿图像将通过JS动态加载 -->
                                        <div class="loading-indicator">
                                            <i class="bi bi-arrow-clockwise"></i>
                                            <span>加载中...</span>
                                        </div>
                                    </div>
                                    <div class="image-actions">
                                        <button class="mobile-btn secondary" onclick="loadMorePostureImages()">查看更多</button>
                                        <button class="mobile-btn primary" onclick="exportPostureImages()">导出记录</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 用眼情况内容 -->
                <div id="eye-content" class="tool-content" style="display: none;">
                    <!-- 用眼监控和每日反馈切换模块 -->
                    <div class="mobile-card">
                        <div class="mobile-card-header">
                            <div class="mobile-card-title" id="eyeCardTitle">用眼监控</div>
                            <div class="eye-status">
                                <span class="status-dot"></span>
                                <span>监控中</span>
                            </div>
                        </div>
                        <div class="mobile-card-content">
                            <!-- 切换指示器 -->
                            <div class="eye-indicators">
                                <div class="indicator-btn active" data-eye-view="0" onclick="switchEyeView(0)">用眼监控</div>
                                <div class="indicator-btn" data-eye-view="1" onclick="switchEyeView(1)">每日反馈</div>
                            </div>
                            
                            <!-- 可切换的内容容器 -->
                            <div class="eye-swiper" id="eyeSwiper">
                                <!-- 用眼监控内容 -->
                                <div class="eye-slide active" id="eye-slide-0">
                                    <div class="eye-metrics">
                                        <div class="metric-item">
                                            <div class="metric-icon">
                                                <i class="bi bi-clock"></i>
                                            </div>
                                            <div class="metric-info">
                                                <div class="metric-value">2.5小时</div>
                                                <div class="metric-label">连续用眼时间</div>
                                            </div>
                                        </div>
                                        <div class="metric-item">
                                            <div class="metric-icon">
                                                <i class="bi bi-eye"></i>
                                            </div>
                                            <div class="metric-info">
                                                <div class="metric-value">15次/分钟</div>
                                                <div class="metric-label">眨眼频率</div>
                                            </div>
                                        </div>
                                        <div class="metric-item">
                                            <div class="metric-icon">
                                                <i class="bi bi-phone"></i>
                                            </div>
                                            <div class="metric-info">
                                                <div class="metric-value">45cm</div>
                                                <div class="metric-label">眼屏距离</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- 每日反馈内容 -->
                                <div class="eye-slide" id="eye-slide-1">
                                    <div class="feedback-list">
                                        <div class="feedback-item positive">
                                            <div class="feedback-badge">
                                                <i class="bi bi-check-circle-fill"></i>
                                            </div>
                                            <div class="feedback-content">
                                                <div class="feedback-text">本周平均远眺次数：<strong>4.3 次/天</strong></div>
                                            </div>
                                        </div>
                                        <div class="feedback-item positive">
                                            <div class="feedback-badge">
                                                <i class="bi bi-brightness-high-fill"></i>
                                            </div>
                                            <div class="feedback-content">
                                                <div class="feedback-text">当前环境光照：<strong>良好</strong></div>
                                            </div>
                                        </div>
                                        <div class="feedback-item positive">
                                            <div class="feedback-badge">
                                                <i class="bi bi-thermometer-sun"></i>
                                            </div>
                                            <div class="feedback-content">
                                                <div class="feedback-text">色温状态：<strong>柔和</strong></div>
                                            </div>
                                        </div>
                                        <div class="feedback-item warning">
                                            <div class="feedback-badge">
                                                <i class="bi bi-exclamation-triangle-fill"></i>
                                            </div>
                                            <div class="feedback-content">
                                                <div class="feedback-text">昨日连续用眼超时：<strong>72 分钟</strong></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 用眼时间热力图 -->
                    <div class="mobile-card">
                        <div class="mobile-card-header">
                            <div class="mobile-card-title">用眼时间热力图</div>
                            <div class="heatmap-icon">
                                <i class="bi bi-calendar-week"></i>
                            </div>
                        </div>
                        <div class="mobile-card-content">
                            <div class="heatmap-container">
                                <div id="eyeHeatmapChart"></div>
                            </div>
                            <div class="heatmap-legend">
                                <div class="legend-title">用眼强度</div>
                                <div class="legend-scale">
                                    <div class="legend-item">
                                        <div class="legend-color low"></div>
                                        <span>低</span>
                                    </div>
                                    <div class="legend-item">
                                        <div class="legend-color medium"></div>
                                        <span>中</span>
                                    </div>
                                    <div class="legend-item">
                                        <div class="legend-color high"></div>
                                        <span>高</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 情绪反馈内容 -->
                <div id="emotion-content" class="tool-content" style="display: none;">
                    <!-- 情绪异常提醒小卡片 -->
                    <div class="mobile-card emotion-alert">
                        <div class="mobile-card-header">
                            <div class="mobile-card-title">情绪异常提醒</div>
                            <div class="alert-status">
                                <span class="status-dot warning"></span>
                                <span>需关注</span>
                            </div>
                        </div>
                        <div class="mobile-card-content">
                            <div class="alert-content">
                                <div class="alert-item">
                                    <div class="alert-icon">
                                        <i class="bi bi-exclamation-triangle"></i>
                                    </div>
                                    <div class="alert-info">
                                        <div class="alert-text">检测到孩子在下午3:30出现焦虑情绪，持续约15分钟</div>
                                        <div class="alert-time">2小时前</div>
                                    </div>
                                </div>
                                <div class="alert-actions">
                                    <button class="alert-btn primary">发送关怀消息</button>
                                    <button class="alert-btn secondary">查看详情</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 孩子情绪动态反馈面板 -->
                    <div class="mobile-card">
                        <div class="mobile-card-header">
                            <div class="mobile-card-title">孩子情绪动态反馈面板</div>
                            <div class="emotion-view-switcher">
                                <select id="emotionViewSelect" class="view-select">
                                    <option value="radar">雷达图</option>
                                    <option value="trend">趋势图</option>
                                    <option value="distribution">分布图</option>
                                    <option value="heatmap">热力图</option>
                                </select>
                            </div>
                        </div>
                        <div class="mobile-card-content">
                            <!-- 情绪图表容器 -->
                            <div class="emotion-charts-container">
                                <!-- 雷达图 -->
                                <div class="emotion-chart-view active" id="emotion-radar-view">
                                    <div class="chart-container">
                                        <canvas id="emotionRadarChart"></canvas>
                                    </div>
                                    <div class="emotion-summary">
                                        <div class="summary-item">
                                            <span class="emotion-label">今日主导情绪</span>
                                            <span class="emotion-value">高兴 😊 (4.2/5)</span>
                                        </div>
                                        <div class="summary-item">
                                            <span class="emotion-label">情绪稳定度</span>
                                            <span class="emotion-value stable">良好 (比昨日上升15%)</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- 趋势图 -->
                                <div class="emotion-chart-view" id="emotion-trend-view">
                                    <div class="chart-container">
                                        <canvas id="emotionTrendChart"></canvas>
                                    </div>
                                    <div class="trend-insights">
                                        <div class="insight-item positive">
                                            <i class="bi bi-arrow-up"></i>
                                            <span>今日平均情绪值1.8，比昨日提升0.3</span>
                                        </div>
                                        <div class="insight-item neutral">
                                            <i class="bi bi-clock"></i>
                                            <span>下午14-16点为情绪高峰期</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- 分布图 -->
                                <div class="emotion-chart-view" id="emotion-distribution-view">
                                    <div class="chart-container">
                                        <div id="emotionDistributionChart"></div>
                                    </div>
                                    <div class="distribution-stats">
                                        <div class="stat-row">
                                            <span class="stat-label">高兴情绪</span>
                                            <span class="stat-value positive">40次</span>
                                        </div>
                                        <div class="stat-row">
                                            <span class="stat-label">平静情绪</span>
                                            <span class="stat-value neutral">40次</span>
                                        </div>
                                        <div class="stat-row">
                                            <span class="stat-label">其他情绪</span>
                                            <span class="stat-value negative">22次</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- 热力图 -->
                                <div class="emotion-chart-view" id="emotion-heatmap-view">
                                    <div class="chart-container">
                                        <div id="emotionHeatmapChart"></div>
                                    </div>
                                    <div class="heatmap-legend">
                                        <div class="legend-title">情绪强度</div>
                                        <div class="legend-scale">
                                            <div class="legend-item">
                                                <div class="legend-color low"></div>
                                                <span>平静</span>
                                            </div>
                                            <div class="legend-item">
                                                <div class="legend-color medium"></div>
                                                <span>一般</span>
                                            </div>
                                            <div class="legend-item">
                                                <div class="legend-color high"></div>
                                                <span>强烈</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 底部导航 -->
    <nav class="mobile-nav">
        <a href="#" class="nav-item active" data-page="home">
            <i class="bi bi-house nav-icon"></i>
            <span>首页</span>
        </a>
        <a href="#" class="nav-item" data-page="guardian">
            <i class="bi bi-shield-check nav-icon"></i>
            <span>家长监护</span>
        </a>
        <a href="#" class="nav-item" data-page="remote">
            <i class="bi bi-toggles nav-icon"></i>
            <span>远程控制</span>
        </a>
        <a href="#" class="nav-item" data-page="settings">
            <i class="bi bi-gear nav-icon"></i>
            <span>设置</span>
        </a>
    </nav>
    
    <!-- 样式扩展 -->
    <style>
        /* 工具网格样式 */
        .tools-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }
        
        .tool-item {
            display: flex;
            align-items: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid #e9ecef;
        }
        
        .tool-item:hover, .tool-item:active {
            background: #e3f2fd;
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }
        
        .tool-icon {
            width: 48px;
            height: 48px;
            background: var(--primary-color);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            margin-right: 15px;
        }
        
        .tool-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--dark-gray);
            margin-bottom: 2px;
        }
        
        .tool-desc {
            font-size: 0.9rem;
            color: #666;
        }
        
        /* 概览统计样式 */
        .overview-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            text-align: center;
        }
        
        .stat-item {
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .stat-value {
            font-size: 1.4rem;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 4px;
        }
        
        .stat-label {
            font-size: 0.8rem;
            color: #666;
        }
        
        /* 视频容器样式 */
        .video-wrapper {
            position: relative;
            width: 100%;
            background: #000;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .video-wrapper img {
            width: 100%;
            display: block;
        }
        
        .video-error {
            padding: 40px 20px;
            text-align: center;
            color: white;
        }
        
        .video-error i {
            font-size: 3rem;
            margin-bottom: 10px;
            opacity: 0.7;
        }
        
        /* 快速操作样式 */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        
        .action-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px 10px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .action-btn:hover {
            background: #f0f7ff;
            border-color: var(--primary-color);
        }
        
        .action-btn i {
            font-size: 1.5rem;
            margin-bottom: 5px;
            color: var(--primary-color);
        }
        
        .action-btn span {
            font-size: 0.9rem;
            color: var(--dark-gray);
        }
        
        /* 工具详情页面样式 */
        .tool-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px;
            background: white;
            border-bottom: 1px solid #eee;
            position: sticky;
            top: 60px;
            z-index: 90;
        }
        
        .back-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: #f5f5f5;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2rem;
        }
        
        .tool-content {
            padding-bottom: 70px;
        }
        
        /* 消息推送样式 */
        .message-input textarea {
            width: 100%;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 10px;
            resize: vertical;
            font-family: inherit;
        }
        
        .message-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .message-actions select {
            flex: 1;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .message-history {
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .message-item {
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 8px;
            border-left: 3px solid var(--primary-color);
        }
        
        .message-item.scheduled {
            border-left-color: var(--warning-color);
            background: rgba(251, 188, 5, 0.1);
        }
        
        .message-sender {
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: 600;
            color: var(--primary-color);
            font-size: 0.9rem;
            margin-bottom: 3px;
        }
        
        .message-content {
            color: var(--text-color);
            line-height: 1.4;
            margin-bottom: 5px;
        }
        
        .message-time {
            font-size: 0.8rem;
            color: #666;
        }
        
        /* 控制面板样式 */
        .control-section {
            margin-bottom: 25px;
        }
        
        .section-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--dark-gray);
        }
        
        .control-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        
        .control-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px 10px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .control-btn:hover {
            background: #f0f7ff;
            border-color: var(--primary-color);
        }
        
        .control-btn i {
            font-size: 1.3rem;
            margin-bottom: 5px;
            color: var(--primary-color);
        }
        
        /* 滑块样式 */
        .slider-container {
            margin: 15px 0;
        }
        
        .slider {
            width: 100%;
            -webkit-appearance: none;
            appearance: none;
            height: 6px;
            border-radius: 3px;
            background: #ddd;
            outline: none;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary-color);
            cursor: pointer;
        }
        
        .slider-value {
            text-align: center;
            margin-top: 8px;
            font-weight: 600;
            color: var(--primary-color);
        }
        
        /* 模式按钮网格 */
        .mode-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        
        .mode-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 12px 8px;
            background: white;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .mode-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }
        
        /* 定时器设置样式 */
        .timer-settings {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .timer-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .timer-toggle {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #ccc;
            cursor: pointer;
        }
        
        .timer-toggle.active {
            color: var(--primary-color);
        }
        
        /* 设置页面样式 */
        .setting-list {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }
        
        .setting-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .setting-toggle {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #ccc;
            cursor: pointer;
        }
        
        .setting-toggle.active {
            color: var(--primary-color);
        }
        
        .account-info {
            text-align: center;
        }
        
        .avatar-section {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: #999;
            margin-right: 15px;
        }
        
        .user-info {
            text-align: left;
        }
        
        .username {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 2px;
        }
        
        .user-role {
            font-size: 0.9rem;
            color: #666;
        }
        
        .account-actions {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }
        
        .action-item {
            display: flex;
            align-items: center;
            padding: 15px 0;
            background: none;
            border: none;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
            text-align: left;
        }
        
        .action-item i:first-child {
            margin-right: 12px;
            color: var(--primary-color);
        }
        
        .action-item span {
            flex: 1;
        }
        
        .action-item.logout {
            color: var(--danger-color);
        }
        
        .action-item.logout i {
            color: var(--danger-color);
        }
        
        /* 坐姿统计网格样式 */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            text-align: center;
        }
        
        /* 用眼情况模块样式 */
        .eye-metrics {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }
        
        .metric-item {
            display: flex;
            align-items: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid var(--primary-color);
        }
        
        .metric-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            margin-right: 12px;
            font-size: 1.2rem;
        }
        
        .metric-info {
            flex: 1;
        }
        
        .metric-value {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 2px;
        }
        
        .metric-label {
            font-size: 0.9rem;
            color: #666;
        }
        
        /* 每日反馈样式 */
        .feedback-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .feedback-item {
            display: flex;
            align-items: flex-start;
            padding: 12px;
            border-radius: 8px;
            background: #f8f9fa;
        }
        
        .feedback-item.positive {
            border-left: 4px solid var(--secondary-color);
            background: rgba(52, 168, 83, 0.05);
        }
        
        .feedback-item.warning {
            border-left: 4px solid var(--warning-color);
            background: rgba(251, 188, 5, 0.05);
        }
        
        .feedback-badge {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            margin-top: 2px;
        }
        
        .feedback-item.positive .feedback-badge i {
            color: var(--secondary-color);
            font-size: 1.1rem;
        }
        
        .feedback-item.warning .feedback-badge i {
            color: var(--warning-color);
            font-size: 1.1rem;
        }
        
        .feedback-content {
            flex: 1;
        }
        
        .feedback-text {
            line-height: 1.4;
            color: var(--text-color);
        }
        
        .feedback-text strong {
            color: var(--primary-color);
        }
        
        /* 热力图样式 */
        .heatmap-container {
            position: relative;
            height: 250px;
            margin-bottom: 15px;
        }
        
        .heatmap-legend {
            margin-top: 15px;
        }
        
        .legend-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--dark-gray);
            margin-bottom: 8px;
            text-align: center;
        }
        
        .legend-scale {
            display: flex;
            justify-content: space-around;
            align-items: center;
        }
        
        .legend-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }
        
        .legend-color.low {
            background: #e8f5e8;
        }
        
        .legend-color.medium {
            background: #ffeaa7;
        }
        
        .legend-color.high {
            background: #fdcb6e;
        }
        
        .legend-item span {
            font-size: 0.8rem;
            color: #666;
        }
        
        /* 用眼情况切换样式 */
        .eye-indicators {
            display: flex;
            background: #f0f0f0;
            border-radius: 8px;
            padding: 4px;
            margin-bottom: 20px;
        }
        
        .indicator-btn {
            flex: 1;
            padding: 8px 12px;
            text-align: center;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-weight: 500;
            color: #666;
        }
        
        .indicator-btn.active {
            background: var(--primary-color);
            color: white;
        }
        
        .eye-swiper {
            position: relative;
            overflow: hidden;
        }
        
        .eye-slide {
            display: none;
        }
        
        .eye-slide.active {
            display: block;
        }
        
        /* ...existing code... */
    </style>
    
    <script src="{{ url_for('static', filename='js/mobile.js') }}"></script>
    

    

</body>
</html>
